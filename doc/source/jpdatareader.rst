
リモートデータアクセス
======================

``jpd.DataReader`` を利用すると、国内のデータソースの情報を ``DataFrame`` として取得できます。以下のデータソースをサポートしています。

- ``yahoojp``: Yahoo! ファイナンスから国内株式の情報を取得。
- ``estat``: e-Stat API から統計情報を取得。
- ほか、``pd.DataReader`` でサポートしているデータソース

利用できるオプションは ``pd.DataReader`` とほぼ同一です。ここでは、差異がある点のみ記載します。

Yahoo! ファイナンス
-----------------

.. code-block:: python

    >>> import pandas as pd
    >>> import japandas as jpd

    >>> jpd.DataReader(7203, 'yahoojp', start='2014-10-01', end='2014-10-05')
                  始値    高値    安値    終値       出来高  調整後終値*
    日付
    2014-10-01  6450  6559  6435  6500  14482100    6500
    2014-10-02  6370  6423  6256  6275  15240200    6275
    2014-10-03  6231  6309  6217  6290  10280100    6290

``en=True`` を指定すると、 Yahoo! ファイナンスから取得する列名を ``pd.DataReader`` と同じ列名に変更できます。

.. code-block:: python

    >>> jpd.DataReader(7203, 'yahoojp', start='2014-10-01', end='2014-10-05', en=True)
                Open  High   Low  Close    Volume  Adj Close
    Date
    2014-10-01  6450  6559  6435   6500  14482100       6500
    2014-10-02  6370  6423  6256   6275  15240200       6275
    2014-10-03  6231  6309  6217   6290  10280100       6290

``interval`` を指定すると、データの集計単位を変更できます。指定できるのは 以下の 3 種類です。

- ``d``: 日次。デフォルト。
- ``w``: 週次。
- ``m``: 月次。

.. code-block:: python

    >>> jpd.DataReader(7203, 'yahoojp', start='2014-10-01', end='2014-12-31', interval='m')
                  始値    高値    安値    終値        出来高  調整後終値*
    日付
    2014-10-01  6450  6559  5710  6498  233353400    6498
    2014-11-01  6830  7314  6696  7314  232048700    7314
    2014-12-01  7360  7873  7107  7558  244583800    7558


e-Stat API
----------

以下のコードに対応するデータを取得できます。

- 政府統計コード (8桁): `e-Stat API 提供データ <http://www.e-stat.go.jp/api/api-data/>`_ から確認できる 8桁のコードです。取得したデータには、各統計に付随する "統計表ID" が含まれます。
- 統計表ID: 実データを含む表のIDです。

まず、取得したいデータを含む政府統計コードから統計表IDの一覧を取得します。

.. code-block:: python

    >>> key = "your application id"
    >>> dlist = jpd.DataReader("00200521", 'estat', appid=key)
    >>> dlist.head()
            統計表ID 政府統計名 作成機関名           提供統計名及び提供分類名  \
    0  0000030001  国勢調査   総務省  昭和55年国勢調査 第1次基本集計 全国編
    1  0000030002  国勢調査   総務省  昭和55年国勢調査 第1次基本集計 全国編
    2  0000030003  国勢調査   総務省  昭和55年国勢調査 第1次基本集計 全国編
    3  0000030004  国勢調査   総務省  昭和55年国勢調査 第1次基本集計 全国編
    4  0000030005  国勢調査   総務省  昭和55年国勢調査 第1次基本集計 全国編

                                              統計表題名及び表番号 提供周期    調査年月        公開日  \
    0  男女の別（性別）（３），年齢５歳階級（２３），人口 全国・市部・郡部・都道府県（４７），全域...    -  198010 2007-10-05
    1  男女の別（性別）（３），年齢各歳階級（１０３），人口 全国・市部・郡部・都道府県（４７），全...    -  198010 2007-10-05
    2  総人口・日本人（２），男女の別（性別）（２），年齢各歳階級（１２２），出生の月（５），人口 ...    -  198010 2007-10-05
    3  総人口・日本人（２），男女の別（性別）（２），年齢各歳階級（８６），配偶関係（５），１５歳以...    -  198010 2007-10-05
    4  男女の別（性別）（３），年齢５歳階級（１９），国籍（５），外国人数 全国・市部・郡部・都道府...    -  198010 2007-10-05

      小地域属性フラグ 統計大分野名 統計小分野名     総件数      最終更新日
    0        0  人口・世帯     人口    3651 2008-03-19
    1        0  人口・世帯     人口   16365 2008-03-19
    2        0  人口・世帯     人口  123782 2008-03-19
    3        0  人口・世帯     人口   85848 2008-03-19
    4        0  人口・世帯     人口   13082 2008-03-19

結果から取得したい統計表IDを確認し、実データを取得します。複数のデータをまとめて取得したい場合は
そのリストを渡します。

.. code-block:: python

    >>> df = jpd.DataReader("0000030001", 'estat', appid=key)
    >>> df.head()
                 value 全国都道府県030001 全域・集中の別030002 年齢５歳階級Ａ030002 男女Ａ030001
    時間軸(年次)
    1980年    117060396           全国            全域            総数      男女総数
    1980年     89187409         全国市部            全域            総数      男女総数
    1980年     27872987         全国郡部            全域            総数      男女総数
    1980年      5575989          北海道            全域            総数      男女総数
    1980年      1523907          青森県            全域            総数      男女総数

    >>> df = jpd.DataReader(["0000030001", "0000030002"], 'estat', appid=key)
    >>> df.head()
                 value 全国都道府県030001 全域・集中の別030002 年齢各歳階級Ｂ030003 年齢５歳階級Ａ030002  \
    時間軸(年次)
    1980年    117060396           全国            全域           NaN            総数
    1980年     89187409         全国市部            全域           NaN            総数
    1980年     27872987         全国郡部            全域           NaN            総数
    1980年      5575989          北海道            全域           NaN            総数
    1980年      1523907          青森県            全域           NaN            総数

            男女Ａ030001
    時間軸(年次)
    1980年        男女総数
    1980年        男女総数
    1980年        男女総数
    1980年        男女総数
    1980年        男女総数
